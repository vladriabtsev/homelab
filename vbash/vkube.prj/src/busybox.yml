name: busybox
help: Busybox container

commands:
- name: install
  help: |-
    Install busybox container with disks for all storage classes:
    - All storage classes from --cluster-plan flag.
    - All storage classes from --synology-csi-plan flag.
    - All storage classes from --storage-class flags.
  args:
  - name: storage-class
    help: Storage class name
    repeatable: true
    required: true
    unique: true
  flags:
  - long: --all-storage-classes
    help: Use all storage types
  - long: --all-storage-classes-ext
    arg: storage-classes-ext
    default: del
    allowed: [del, ret, ext]
    help: Storage class name extension for flag --all-storage-classes. Example 'longhorn-del'
  - long: --deployment
    short: -d
    arg: deployment
    help: Name of busybox deployment.
    default: busybox
  - long: --release
    short: -r
    arg: release
    help: Busybox release version
    default: latest
  - long: --namespace
    short: -n
    arg: namespace
    default: default
    help: Namespace name
  - long: --storage-size
    short: -s
    arg: storage-size-request
    default: 1Gi
    help: Storage size request for persistent volume claims for each storage class
    conflicts: [--cluster-plan, --synology-csi-plan]
  - long: --access-mode
    short: -a
    arg: access-mode
    default: ReadWriteOnce
    allowed: [ReadWriteOnce, ReadOnlyMany, ReadWriteMany, ReadWriteOncePod] # https://spacelift.io/blog/kubernetes-persistent-volumes
    help: Storage access mode
  # - long: --secret-folder
  #   help: Secret folder with?????
  #   #validate: dir_exists
  #   required: true
  #   arg: folder

- name: uninstall
  help: Uninstall busybox container
  flags:
  - long: --namespace
    short: -n
    arg: namespace
    default: default
    help: Namespace name

# - name: upgrade
#   help: Upgrade busybox release version
#   args:
#   - name: name
#     help: Name of busybox deployment.
#     required: true
#   - name: release
#     help: Busybox release version
#     default: latest

examples:
  - ./vkube busybox --help
  - ./vkube busybox install mybusybox --synology-csi-plan ../synology-csi-plan.yaml
